<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Men's Sports Collection - Sportivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="wishlist-utils.js"></script>
    <script src="cart-utils.js"></script>
    <script src="all-products.js"></script>
    <style>
        .hero-banner {
            background-color: rgb(155, 205, 216);
            height: 100px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            text-align: center;
            margin-bottom: 40px;
        }
        
        .category-filters {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }
        
        .category-btn {
            padding: 8px 20px;
            background: #f5f5f5;
            border: none;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .category-btn.active, 
        .category-btn:hover {
            background: #90ded6;
            color: white;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .section-title h2 {
            font-size: 28px;
            margin-bottom: 10px;
        }
        .back-button {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            margin: 20px 0;
            background-color: #f5f5f5;
            color: #352dd2;
            border: 1px solid #ddd;
            border-radius: 4px;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .back-button:hover {
            background-color: #e0e0e0;
            border-color: #ccc;
        }
        
        .back-button i {
            font-size: 12px;
        }
    </style>
</head>
<body>
    <section id="header">
        <a href="#"><img src="logo.png" alt="logo"></a>
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search products..." >
            <span class="search-icon" onclick="performSearch()">
                <i class="fa fa-search"></i>
            </span>
        </div>
        <div id="top-nav">
            <ul id="navbar">
                <li><a href="homepage.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li id="auth-link"><a href="login.html">Sign In</a></li>
                <li><a href="wishlist.html"><i class="fa fa-heart-o"></i></a></li>
                <li><a href="cart.html"><i class="fa fa-shopping-bag"></i></a></li>
            </ul>
        </div>
    </section>

    <div class="hero-banner">
        <h1>Sports Accessories</h1>
        </div>

    <div class="category-filters">
        <button class="category-btn active" data-category="all">All</button>
        <button class="category-btn" data-category="Swimming">Swimming</button>
    </div>

    <section id="featured" class="section-p1">
        <div class="pro-container">

            <div class="pro" data-category="Swimming">
                <img src="fproduct1.avif" alt="inflated pool ring" onclick="window.location.href='sproduct1.html';">
                <div class="des">
                    <span>NABAIJI</span>
                    <h5>Inflatable Pool Ring 51 cm</h5>
                    <div class="star">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <h4>&#8377;499</h4>
                </div>
                <a href="javascript:void(0)" onclick="handleCartClick(event, 'accessories-pool-ring-1')"><i class="fa fa-shopping-cart cart"></i></a>
                <a href="javascript:void(0)" onclick="handleWishlistToggle(event, 'accessories-pool-ring-1')"><i class="fa fa-heart-o wishlist" data-product-id="accessories-pool-ring-1"></i></a>
            </div>
            <div class="pro" data-category="Swimming">
                <img src="fproduct4.avif" alt="Kids Swimming Goggles UV Protection Anti Fogging Clear Lenses" onclick="window.location.href='sproduct4.html';">
                <div class="des">
                    <span>NABAIJI</span>
                    <h5>Kids Swimming Goggles UV Protection Anti Fogging Clear Lenses Xbase</h5>
                    <div class="star">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <h4>&#8377;399</h4>
                </div>
                <a href="javascript:void(0)" onclick="handleCartClick(event, 'accessories-goggles-1')"><i class="fa fa-shopping-cart cart"></i></a>
                <a href="javascript:void(0)" onclick="handleWishlistToggle(event, 'accessories-goggles-1')"><i class="fa fa-heart-o wishlist" data-product-id="accessories-goggles-1"></i></a>
            </div>
           
            
        </div>
    </section>



    <section id="newsletter">
        <div class="newstext">
            <h4>Sign Up For Newsletter</h4>
            <p>Get E-mail updates about our latest shop and <span>special offers.</span></p>
        </div>
    <div class="form">
        <input type="text" id="newsletterEmail" placeholder="Your email address">
        <button class="normal" id="newsletterSignupBtn">Sign Up</button>
    </div>
    </section>

    <footer class="section-p1">
        <div class="column">
            <img class="logo" src="logo.png" alt="Logo">
            <h4>Contact</h4>
            <p><strong>Address: </strong>535 KM Road, Ernakulam, Kerala</p>
            <p><strong>Phone: </strong>+91 8745987452</p>
            <p><strong>Hours: </strong>10:00 - 18:00. Mon - Sat</p>
        </div>

        <div class="col">
            <h4>About</h4>
            <a href="about.html">About us</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms & Conditions</a>
            <a href="contact.html">Contact us</a>
        </div>

        <div class="col">
            <h4>My Account</h4>
            
            <a href="login.html">Sign In</a>
            <a href="cart.html">View Cart</a>
            <a href="wishlist.html">My Wishlist</a>
            <a href="#">Help</a>
        </div>

        <div class="colpay">
            <h4>Secured Payment Gateways</h4>
            <img src="payment.png" alt="payment gateways">
        </div>
        <div class="copyright">
            <p>&copy; 2025 Sportivo - All rights reserved</p>
        </div>

    </footer>

    <!-- Search Results Section -->
    <section id="searchResults" class="section-p1" style="display: none;">
        <div class="colo">
            <h1>Search Results</h1>
            <h5 id="searchResultsCount"></h5>
        </div>
        <div id="searchResultsContainer" class="pro-container">
            <!-- Search results will be populated here -->
        </div>
        <div id="noResults" style="display: none; text-align: center; padding: 50px;">
            <h3>No products found</h3>
            <p>Try searching with different keywords</p>
        </div>
    </section>

    <script>
        // Product database - ALL products from the entire website
        const products = [
            // Featured Products
            {
                name: "Inflatable Pool Ring 51 cm",
                brand: "NABAIJI",
                price: "₹499",
                image: "fproduct1.avif",
                category: "Swimming",
                link: "sproduct1.html"
            },
            {
                name: "Boys' suit - short sleeve shorty",
                brand: "NABAIJI",
                price: "₹1,299",
                image: "fproduct2.avif",
                category: "Swimming",
                link: "sproduct2.html"
            },
            {
                name: "Girls Swimming Shorty swimsuit",
                brand: "NABAIJI",
                price: "₹1,299",
                image: "fproduct3.avif",
                category: "Swimming",
                link: "sproduct3.html"
            },
            {
                name: "Kids Swimming Goggles UV Protection Anti Fogging Clear Lenses Xbase",
                brand: "NABAIJI",
                price: "₹399",
                image: "fproduct4.avif",
                category: "Swimming",
                link: "sproduct4.html"
            },
            {
                name: "Compact Microfibre Swimming Towel",
                brand: "NABAIJI",
                price: "₹699",
                image: "fproduct5.avif",
                category: "Swimming",
                link: "sproduct5.html"
            },
            {
                name: "Waterproof Bag Ipx6 30 L Orange",
                brand: "ITIWIT",
                price: "₹1,699",
                image: "fproduct6.avif",
                category: "Bags",
                link: "sproduct6.html"
            },
            // New Arrivals
            {
                name: "Cotton Men's Fitness T-Shirt 100 Sport tee",
                brand: "DOMYOS",
                price: "₹299",
                image: "newarrivals1.avif",
                category: "T-shirts",
                link: "sproduct7.html"
            },
            {
                name: "Hiking Backpack 10L, NH100 Arpenaz blue",
                brand: "QUECHUA",
                price: "₹499",
                image: "newarrivals2.avif",
                category: "Bags",
                link: "sproduct8.html"
            },
            {
                name: "Women's waterproof hiking jacket -10°C, NH500 - Blue",
                brand: "QUECHUA",
                price: "₹3,999",
                image: "newarrivals3.avif",
                category: "Jacket",
                link: "sproduct9.html"
            },
            {
                name: "RUN ACTIVE Lightweight Cushioned Men Running Shoes UPTO 10 km/wk - Carmine Red",
                brand: "KALENJI",
                price: "₹2,299",
                image: "newarrivals4.avif",
                category: "Shoes",
                link: "sproduct10.html"
            },
            {
                name: "Aluminium Water Bottle with Easy Locking Cap - 1 Litre Sage Green",
                brand: "QUECHUA",
                price: "₹2,299",
                image: "newarrivals5.avif",
                category: "Accessories",
                link: "sproduct11.html"
            },
            {
                name: "RUN CUSHION Comfortale Lite Antislip Women Running Shoes Turquoise Green",
                brand: "KALENJI",
                price: "₹1,699",
                image: "newarrivals6.avif",
                category: "Shoes",
                link: "sproduct12.html"
            }
        ];

        // Search functionality
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            if (searchTerm === '') {
                hideSearchResults();
                return;
            }
            function getVariants(term) {
                const variants = [term];
                if (term.endsWith('s')) variants.push(term.slice(0, -1));
                else variants.push(term + 's');
                return variants;
            }
            const searchVariants = getVariants(searchTerm);
            function fuzzyMatch(str, term) {
                return str.includes(term) || str.replace(/s$/, '').includes(term.replace(/s$/, ''));
            }
            const filteredProducts = allProducts.filter(product => {
                const fields = [
                    product.name?.toLowerCase() || '',
                    product.brand?.toLowerCase() || '',
                    product.category?.toLowerCase() || '',
                    product.description?.toLowerCase() || ''
                ];
                return searchVariants.some(variant =>
                    fields.some(field => fuzzyMatch(field, variant))
                );
            });
            displaySearchResults(filteredProducts, searchTerm);
        }

        function displaySearchResults(results, searchTerm) {
            const searchResultsSection = document.getElementById('searchResults');
            const searchResultsContainer = document.getElementById('searchResultsContainer');
            const noResults = document.getElementById('noResults');
            const searchResultsCount = document.getElementById('searchResultsCount');

            document.querySelectorAll('section:not(#searchResults):not(#header):not(#newsletter):not(footer)').forEach(section => {
                section.style.display = 'none';
            });
            searchResultsSection.style.display = 'block';

            if (results.length === 0) {
                searchResultsContainer.innerHTML = '';
                noResults.style.display = 'block';
                searchResultsCount.textContent = `No results found for "${searchTerm}"`;
            } else {
                noResults.style.display = 'none';
                searchResultsCount.textContent = `${results.length} result(s) found for "${searchTerm}"`;
                searchResultsContainer.innerHTML = results.map(product => `
                    <div class="pro">
                        <img src="${product.image}" alt="${product.name}" onclick="window.location.href='${product.link}';">
                        <div class="des">
                            <span>${product.brand}</span>
                            <h5>${product.name}</h5>
                            <div class="star">
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                            </div>
                            <h4>${product.price}</h4>
                        </div>
                        <a href="javascript:void(0)" onclick="handleCartClick(event, '${product.id}')"><i class="fa fa-shopping-cart cart"></i></a>
                        <a href="javascript:void(0)" onclick="handleWishlistToggle(event, '${product.id}')"><i class="fa fa-heart-o wishlist" data-product-id="${product.id}"></i></a>
                    </div>
                `).join('');
            }
        }

        function hideSearchResults() {
            const searchResultsSection = document.getElementById('searchResults');
            searchResultsSection.style.display = 'none';
            
            // Show all other sections
            document.querySelectorAll('section:not(#searchResults)').forEach(section => {
                section.style.display = 'block';
            });
        }

        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            
            // Search on Enter key press
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            // Clear search and show all products when input is cleared
            searchInput.addEventListener('input', function() {
                if (this.value === '') {
                    hideSearchResults();
                }
            });
        });

        const filterButtons = document.querySelectorAll('.category-btn');
const products2 = document.querySelectorAll('.pro');

filterButtons.forEach(button => {
    button.addEventListener('click', () => {
        // Update active button
        filterButtons.forEach(btn => btn.classList.remove('active'));
        button.classList.add('active');
        
        const category = button.dataset.category;
        
        // Filter products
        products2.forEach(product => {
            const productCategory = product.dataset.category; // Changed from categories to category
            if (category === 'all' || productCategory === category) {
                product.style.display = 'block';
            } else {
                product.style.display = 'none';
            }
        });
    });
});

        // Authentication UI for all pages
        function checkAuthStatus() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            const authLink = document.getElementById('auth-link');
            if (token && user) {
                const userData = JSON.parse(user);
                authLink.innerHTML = `
                    <div class="user-menu">
                        <span>Welcome, ${userData.name}</span>
                        <a href="#" onclick="logout()">Logout</a>
                    </div>
                `;
            } else {
                authLink.innerHTML = '<a href="login.html">Sign In</a>';
            }
        }
        function logout() {
            const user = localStorage.getItem('user');
            let userId = '';
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    userId = userData.id || userData.email || userData.name || '';
                } catch (e) {}
            }
            if (userId) {
                // Save cart and wishlist to user-specific keys
                const cart = localStorage.getItem('cart');
                const wishlist = localStorage.getItem('wishlist');
                if (cart) localStorage.setItem('cart_' + userId, cart);
                if (wishlist) localStorage.setItem('wishlist_' + userId, wishlist);
            }
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            localStorage.removeItem('cart');
            localStorage.removeItem('wishlist');
            updateCartIcon();
            updateWishlistBadge();
            window.location.reload();
        }

        // On login, restore cart and wishlist from user-specific keys
        document.addEventListener('DOMContentLoaded', function() {
            const user = localStorage.getItem('user');
            let userId = '';
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    userId = userData.id || userData.email || userData.name || '';
                } catch (e) {}
            }
            if (userId) {
                const cart = localStorage.getItem('cart_' + userId);
                const wishlist = localStorage.getItem('wishlist_' + userId);
                // Only restore if generic cart/wishlist is missing
                if (cart && !localStorage.getItem('cart')) localStorage.setItem('cart', cart);
                if (wishlist && !localStorage.getItem('wishlist')) localStorage.setItem('wishlist', wishlist);
            }
        });

        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeWishlistIcons();
            updateCartIcon();
            updateWishlistBadge();
        });

        function toggleWishlist(productId) {
            const isInWishlist = checkWishlistStatus(productId);
            
            if (isInWishlist) {
                removeFromWishlist(productId);
            } else {
                // Get product data based on productId
                const productData = getProductData(productId);
                if (productData) {
                    addToWishlist(productData);
                }
            }
        }

        function getProductData(productId) {
            const productMap = {
                'accessories-pool-ring-1': {
                    id: 'accessories-pool-ring-1',
                    name: 'Inflatable Pool Ring 51 cm',
                    brand: 'NABAIJI',
                    price: '₹499',
                    image: 'fproduct1.avif',
                    category: 'Swimming',
                    link: 'sproduct1.html'
                },
                'accessories-goggles-1': {
                    id: 'accessories-goggles-1',
                    name: 'Kids Swimming Goggles UV Protection Anti Fogging Clear Lenses Xbase',
                    brand: 'NABAIJI',
                    price: '₹399',
                    image: 'fproduct4.avif',
                    category: 'Swimming',
                    link: 'sproduct4.html'
                }
            };
            return productMap[productId];
        }

        document.addEventListener('DOMContentLoaded', function() {
            updateCartIcon && updateCartIcon();
            updateWishlistBadge && updateWishlistBadge();
            initializeWishlistIcons && initializeWishlistIcons();
        });

        window.addEventListener('storage', function(e) {
            if (e.key === 'cart' || e.key === 'wishlist') {
                updateCartIcon && updateCartIcon();
                updateWishlistBadge && updateWishlistBadge();
                initializeWishlistIcons && initializeWishlistIcons();
            }
        });

        // Newsletter signup logic
        const newsletterBtn = document.getElementById('newsletterSignupBtn');
        if (newsletterBtn) {
            newsletterBtn.addEventListener('click', function(e) {
                e.preventDefault();
                const emailInput = document.getElementById('newsletterEmail');
                const email = emailInput.value.trim();
                // Simple email validation
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (emailRegex.test(email)) {
                    alert('Successfully registered.');
                    emailInput.value = '';
                } else {
                    alert('Please enter a valid email address.');
                }
            });
        }
    </script>
</body>
</html>