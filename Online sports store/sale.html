<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Summer Sale - Sportivo</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="style.css">
    <script src="wishlist-utils.js"></script>
    <script src="cart-utils.js"></script>
    <script src="all-products.js"></script>
</head>
<body>
    <section id="header">
        <a href="index.html"><img src="logo.png" alt="logo"></a>
        <div class="search-container">
            <input type="text" class="search-input" id="searchInput" placeholder="Search products...">
            <span class="search-icon" onclick="performSearch()">
                <i class="fa fa-search"></i>
            </span>
        </div>

        <div id="top-nav">
            <ul id="navbar">
                <li><a href="homepage.html">Home</a></li>
                <li><a href="about.html">About</a></li>
                <li><a href="contact.html">Contact</a></li>
                <li id="auth-link"><a href="login.html">Sign In</a></li>
                <li><a href="wishlist.html"><i class="fa fa-heart-o"></i></a></li>
                <li><a href="cart.html"><i class="fa fa-shopping-bag"></i></a></li>
            </ul>
        </div>
    </section>

   

    <div class="sale-banner">
        <h1>SUMMER SALE</h1>
        <div class="discount-badge">UP TO 30% OFF</div>
        <h2>Limited Time Only - Don't Miss Out!</h2>
        <div class="sale-countdown">
            <i class="fa fa-clock-o"></i> Sale ends in: <span id="countdown">3 days 12:45:32</span>
        </div>
        <button class="normal" onclick="window.location.href='shop.html';">Shop Sale Items</button>
    </div>

    <section id="sale-categories">
        <div class="sale-categories">
            <div class="sale-category" onclick="window.location.href='men.html';">
                <div class="sale-category-info">
                    <h3>Men's Collection</h3>
                    <div class="discount-tag">30-50% OFF</div>
                    <button class="normal">Shop Now</button>
                </div>
            </div>

            <div class="sale-category" onclick="window.location.href='women.html';">
                <div class="sale-category-info">
                    <h3>Women's Collection</h3>
                    <div class="discount-tag">30-50% OFF</div>
                    <button class="normal">Shop Now</button>
                </div>
            </div>

            <div class="sale-category" onclick="window.location.href='kids.html';">
                <div class="sale-category-info">
                    <h3>Kids Collection</h3>
                    <div class="discount-tag">30-50% OFF</div>
                    <button class="normal">Shop Now</button>
                </div>
            </div>

            <div class="sale-category" onclick="window.location.href='accessories.html';">
                <div class="sale-category-info">
                    <h3>Sports Accessories</h3>
                    <div class="discount-tag">30-50% OFF</div>
                    <button class="normal">Shop Now</button>
                </div>
            </div>
            
            
            
          
        </div>
    </section>

    <section id="featured" class="section-p1">
        <div class="colo">
        <h1>Hot Deals</h1>
        <h5>Limited Stock at These Prices!</h5>
    </div>
        <div class="pro-container">
            <div class="pro">
                <img src="fproduct1.avif" alt="inflated pool ring" onclick="window.location.href='sproduct1.html';">
                <div class="des">
                    <span>NABAIJI</span>
                    <h5>Inflatable Pool Ring 51 cm</h5>
                    <div class="star">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <h4><s>&#8377;600</s></h4>
                    <h4>&#8377;499</h4>
                </div>
                <a href="javascript:void(0)" onclick="handleCartClick(event, 'sale-search-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-shopping-cart cart"></i></a>
                <a href="javascript:void(0)" onclick="handleWishlistToggle(event, '${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-heart-o wishlist" data-product-id="${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}"></i></a>
            </div>

            <div class="pro">
                <img src="fproduct2.avif" alt="Boys' suit" onclick="window.location.href='sproduct2.html';">
                <div class="des">
                    <span>NABAIJI</span>
                    <h5>Boys' suit - short sleeve shorty</h5>
                    <div class="star">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <h4><s>&#8377;2000</s></h4>
                    <h4>&#8377;1,299</h4>
                </div>
                <a href="javascript:void(0)" onclick="handleCartClick(event, 'sale-search-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-shopping-cart cart"></i></a>
                <a href="javascript:void(0)" onclick="handleWishlistToggle(event, '${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-heart-o wishlist" data-product-id="${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}"></i></a>
            </div>

            <div class="pro">
                <img src="fproduct3.avif" alt="Girls Swimming Shorty swimsuit Blue Pink" onclick="window.location.href='sproduct3.html';">
                <div class="des">
                    <span>NABAIJI</span>
                    <h5>Girls Swimming Shorty swimsuit</h5>
                    <div class="star">
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                        <i class="fa fa-star"></i>
                    </div>
                    <h4><s>&#8377;2000</s></h4>
                    <h4>&#8377;1,299</h4>
                </div>
                <a href="javascript:void(0)" onclick="handleCartClick(event, 'sale-search-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-shopping-cart cart"></i></a>
                <a href="javascript:void(0)" onclick="handleWishlistToggle(event, '${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}')"><i class="fa fa-heart-o wishlist" data-product-id="${product.category}-${product.name.replace(/\s+/g, '-').toLowerCase()}"></i></a>
            </div>
        </div>
    </section>

           

    <section id="newsletter">
        <div class="newstext">
            <h4>Sign Up For Newsletter</h4>
            <p>Get E-mail updates about our latest shop and <span>special offers.</span></p>
        </div>
        <div class="form">
            <input type="text" placeholder="Your email address">
            <button class="normal">Sign Up</button>
        </div>
    </section>

    <footer class="section-p1">
        <div class="column">
            <img class="logo" src="logo.png" alt="Logo">
            <h4>Contact</h4>
            <p><strong>Address: </strong>535 KM Road, Ernakulam, Kerala</p>
            <p><strong>Phone: </strong>+91 8745987452</p>
            <p><strong>Hours: </strong>10:00 - 18:00. Mon - Sat</p>
        </div>

        <div class="col">
            <h4>About</h4>
            <a href="about.html">About us</a>
            <a href="#">Privacy Policy</a>
            <a href="#">Terms & Conditions</a>
            <a href="contact.html">Contact us</a>
        </div>

        <div class="col">
            <h4>My Account</h4>
            
            <a href="login.html">Sign In</a>
            <a href="cart.html">View Cart</a>
            <a href="wishlist.html">My Wishlist</a>
            <a href="#">Help</a>
        </div>

        <div class="colpay">
            <h4>Secured Payment Gateways</h4>
            <img src="payment.png" alt="payment gateways">
        </div>
        <div class="copyright">
            <p>&copy; 2025 Sportivo - All rights reserved</p>
        </div>

    </footer>

    <!-- Search Results Section -->
    <section id="searchResults" class="section-p1" style="display: none;">
        <div class="colo">
            <h1>Search Results</h1>
            <h5 id="searchResultsCount"></h5>
        </div>
        <div id="searchResultsContainer" class="pro-container">
            <!-- Search results will be populated here -->
        </div>
        <div id="noResults" style="display: none; text-align: center; padding: 50px;">
            <h3>No products found</h3>
            <p>Try searching with different keywords</p>
        </div>
    </section>

    <script>
        // Product database - ALL products from the entire website
        const products = [
            // Featured Products
            {
                name: "Inflatable Pool Ring 51 cm",
                brand: "NABAIJI",
                price: "₹499",
                image: "fproduct1.avif",
                category: "Swimming",
                link: "sproduct1.html"
            },
            {
                name: "Boys' suit - short sleeve shorty",
                brand: "NABAIJI",
                price: "₹1,299",
                image: "fproduct2.avif",
                category: "Swimming",
                link: "sproduct2.html"
            },
            {
                name: "Girls Swimming Shorty swimsuit",
                brand: "NABAIJI",
                price: "₹1,299",
                image: "fproduct3.avif",
                category: "Swimming",
                link: "sproduct3.html"
            },
            {
                name: "Kids Swimming Goggles UV Protection Anti Fogging Clear Lenses Xbase",
                brand: "NABAIJI",
                price: "₹399",
                image: "fproduct4.avif",
                category: "Swimming",
                link: "sproduct4.html"
            },
            {
                name: "Compact Microfibre Swimming Towel",
                brand: "NABAIJI",
                price: "₹699",
                image: "fproduct5.avif",
                category: "Swimming",
                link: "sproduct5.html"
            },
            {
                name: "Waterproof Bag Ipx6 30 L Orange",
                brand: "ITIWIT",
                price: "₹1,699",
                image: "fproduct6.avif",
                category: "Bags",
                link: "sproduct6.html"
            },
            // New Arrivals
            {
                name: "Cotton Men's Fitness T-Shirt 100 Sport tee",
                brand: "DOMYOS",
                price: "₹299",
                image: "newarrivals1.avif",
                category: "T-shirts",
                link: "sproduct7.html"
            },
            {
                name: "Hiking Backpack 10L, NH100 Arpenaz blue",
                brand: "QUECHUA",
                price: "₹499",
                image: "newarrivals2.avif",
                category: "Bags",
                link: "sproduct8.html"
            },
            {
                name: "Women's waterproof hiking jacket -10°C, NH500 - Blue",
                brand: "QUECHUA",
                price: "₹3,999",
                image: "newarrivals3.avif",
                category: "Jacket",
                link: "sproduct9.html"
            },
            {
                name: "RUN ACTIVE Lightweight Cushioned Men Running Shoes UPTO 10 km/wk - Carmine Red",
                brand: "KALENJI",
                price: "₹2,299",
                image: "newarrivals4.avif",
                category: "Shoes",
                link: "sproduct10.html"
            },
            {
                name: "Aluminium Water Bottle with Easy Locking Cap - 1 Litre Sage Green",
                brand: "QUECHUA",
                price: "₹2,299",
                image: "newarrivals5.avif",
                category: "Accessories",
                link: "sproduct11.html"
            },
            {
                name: "RUN CUSHION Comfortale Lite Antislip Women Running Shoes Turquoise Green",
                brand: "KALENJI",
                price: "₹1,699",
                image: "newarrivals6.avif",
                category: "Shoes",
                link: "sproduct12.html"
            }
        ];

        // Sale products with original prices for display
        const saleProducts = [
            {
                name: "Inflatable Pool Ring 51 cm",
                brand: "NABAIJI",
                price: "₹499",
                originalPrice: "₹600",
                image: "fproduct1.avif",
                category: "Swimming",
                link: "sproduct1.html"
            },
            {
                name: "Boys' suit - short sleeve shorty",
                brand: "NABAIJI",
                price: "₹1,299",
                originalPrice: "₹2,000",
                image: "fproduct2.avif",
                category: "Swimming",
                link: "sproduct2.html"
            },
            {
                name: "Girls Swimming Shorty swimsuit",
                brand: "NABAIJI",
                price: "₹1,299",
                originalPrice: "₹2,000",
                image: "fproduct3.avif",
                category: "Swimming",
                link: "sproduct3.html"
            }
        ];

        // Search functionality
        function performSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            if (searchTerm === '') {
                hideSearchResults();
                return;
            }
            function getVariants(term) {
                const variants = [term];
                if (term.endsWith('s')) variants.push(term.slice(0, -1));
                else variants.push(term + 's');
                return variants;
            }
            const searchVariants = getVariants(searchTerm);
            function fuzzyMatch(str, term) {
                return str.includes(term) || str.replace(/s$/, '').includes(term.replace(/s$/, ''));
            }
            const filteredProducts = allProducts.filter(product => {
                const fields = [
                    product.name?.toLowerCase() || '',
                    product.brand?.toLowerCase() || '',
                    product.category?.toLowerCase() || '',
                    product.description?.toLowerCase() || ''
                ];
                return searchVariants.some(variant =>
                    fields.some(field => fuzzyMatch(field, variant))
                );
            });
            displaySearchResults(filteredProducts, searchTerm);
        }

        function displaySearchResults(results, searchTerm) {
            const searchResultsSection = document.getElementById('searchResults');
            const searchResultsContainer = document.getElementById('searchResultsContainer');
            const noResults = document.getElementById('noResults');
            const searchResultsCount = document.getElementById('searchResultsCount');

            document.querySelectorAll('section:not(#searchResults):not(#header):not(#newsletter):not(footer)').forEach(section => {
                section.style.display = 'none';
            });
            searchResultsSection.style.display = 'block';

            if (results.length === 0) {
                searchResultsContainer.innerHTML = '';
                noResults.style.display = 'block';
                searchResultsCount.textContent = `No results found for "${searchTerm}"`;
            } else {
                noResults.style.display = 'none';
                searchResultsCount.textContent = `${results.length} result(s) found for "${searchTerm}"`;
                searchResultsContainer.innerHTML = results.map(product => `
                    <div class="pro">
                        <img src="${product.image}" alt="${product.name}" onclick="window.location.href='${product.link}';">
                        <div class="des">
                            <span>${product.brand}</span>
                            <h5>${product.name}</h5>
                            <div class="star">
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                                <i class="fa fa-star"></i>
                            </div>
                            <h4>${product.price}</h4>
                        </div>
                        <a href="javascript:void(0)" onclick="handleCartClick(event, '${product.id}')"><i class="fa fa-shopping-cart cart"></i></a>
                        <a href="javascript:void(0)" onclick="handleWishlistToggle(event, '${product.id}')"><i class="fa fa-heart-o wishlist" data-product-id="${product.id}"></i></a>
                    </div>
                `).join('');
            }
        }

        function hideSearchResults() {
            const searchResultsSection = document.getElementById('searchResults');
            searchResultsSection.style.display = 'none';
            
            // Show all other sections
            document.querySelectorAll('section:not(#searchResults)').forEach(section => {
                section.style.display = 'block';
            });
        }

        // Add event listeners
        document.addEventListener('DOMContentLoaded', function() {
            const searchInput = document.getElementById('searchInput');
            
            // Search on Enter key press
            searchInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            // Clear search and show all products when input is cleared
            searchInput.addEventListener('input', function() {
                if (this.value === '') {
                    hideSearchResults();
                }
            });
        });

        // Countdown timer for the sale
        function updateCountdown() {
            const endDate = new Date();
            endDate.setDate(endDate.getDate() + 3); // Sale ends in 3 days
            
            const now = new Date().getTime();
            const distance = endDate - now;
            
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((distance % (1000 * 60)) / 1000);
            
            document.getElementById("countdown").innerHTML = 
                `${days}d ${hours}h ${minutes}m ${seconds}s`;
            
            if (distance < 0) {
                clearInterval(countdownTimer);
                document.getElementById("countdown").innerHTML = "SALE ENDED";
            }
        }
        
        const countdownTimer = setInterval(updateCountdown, 1000);
        updateCountdown(); // Initial call
    </script>

    <script>
        // Authentication UI for all pages
        function checkAuthStatus() {
            const token = localStorage.getItem('token');
            const user = localStorage.getItem('user');
            const authLink = document.getElementById('auth-link');
            if (token && user) {
                const userData = JSON.parse(user);
                authLink.innerHTML = `
                    <div class="user-menu">
                        <span>Welcome, ${userData.name}</span>
                        <a href="#" onclick="logout()">Logout</a>
                    </div>
                `;
            } else {
                authLink.innerHTML = '<a href="login.html">Sign In</a>';
            }
        }
        function logout() {
            const user = localStorage.getItem('user');
            let userId = '';
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    userId = userData.id || userData.email || userData.name || '';
                } catch (e) {}
            }
            if (userId) {
                // Save cart and wishlist to user-specific keys
                const cart = localStorage.getItem('cart');
                const wishlist = localStorage.getItem('wishlist');
                if (cart) localStorage.setItem('cart_' + userId, cart);
                if (wishlist) localStorage.setItem('wishlist_' + userId, wishlist);
            }
            localStorage.removeItem('token');
            localStorage.removeItem('user');
            localStorage.removeItem('cart');
            localStorage.removeItem('wishlist');
            updateCartIcon();
            updateWishlistBadge();
            window.location.reload();
        }
        document.addEventListener('DOMContentLoaded', function() {
            checkAuthStatus();
            initializeWishlistIcons();
            updateCartIcon();
            updateWishlistBadge();
            const user = localStorage.getItem('user');
            let userId = '';
            if (user) {
                try {
                    const userData = JSON.parse(user);
                    userId = userData.id || userData.email || userData.name || '';
                } catch (e) {}
            }
            if (userId) {
                const cart = localStorage.getItem('cart_' + userId);
                const wishlist = localStorage.getItem('wishlist_' + userId);
                // Only restore if generic cart/wishlist is missing
                if (cart && !localStorage.getItem('cart')) localStorage.setItem('cart', cart);
                if (wishlist && !localStorage.getItem('wishlist')) localStorage.setItem('wishlist', wishlist);
            }
        });

        function toggleWishlist(productId) {
            const isInWishlist = checkWishlistStatus(productId);
            
            if (isInWishlist) {
                removeFromWishlist(productId);
            } else {
                // Get product data based on productId
                const productData = getProductData(productId);
                if (productData) {
                    addToWishlist(productData);
                }
            }
        }

        function getProductData(productId) {
            const productMap = {
                'sale-pool-ring-1': {
                    id: 'sale-pool-ring-1',
                    name: 'Inflatable Pool Ring 51 cm',
                    brand: 'NABAIJI',
                    price: '₹499',
                    originalPrice: '₹600',
                    image: 'fproduct1.avif',
                    category: 'Swimming',
                    link: 'sproduct1.html'
                },
                'sale-boys-suit-1': {
                    id: 'sale-boys-suit-1',
                    name: 'Boys\' suit - short sleeve shorty',
                    brand: 'NABAIJI',
                    price: '₹1,299',
                    originalPrice: '₹2,000',
                    image: 'fproduct2.avif',
                    category: 'Swimming',
                    link: 'sproduct2.html'
                },
                'sale-girls-swimsuit-1': {
                    id: 'sale-girls-swimsuit-1',
                    name: 'Girls Swimming Shorty swimsuit',
                    brand: 'NABAIJI',
                    price: '₹1,299',
                    originalPrice: '₹2,000',
                    image: 'fproduct3.avif',
                    category: 'Swimming',
                    link: 'sproduct3.html'
                }
            };
            return productMap[productId];
        }
    </script>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
      updateCartIcon && updateCartIcon();
      updateWishlistBadge && updateWishlistBadge();
      initializeWishlistIcons && initializeWishlistIcons();
    });
    window.addEventListener('storage', function(e) {
      if (e.key === 'cart' || e.key === 'wishlist') {
        updateCartIcon && updateCartIcon();
        updateWishlistBadge && updateWishlistBadge();
        initializeWishlistIcons && initializeWishlistIcons();
      }
    });
    </script>
</body>
</html>